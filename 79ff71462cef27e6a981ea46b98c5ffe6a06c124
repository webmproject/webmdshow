{
  "comments": [
    {
      "key": {
        "uuid": "AAAAFn//0Z4\u003d",
        "filename": "vp8encoder/vp8encoderinpin.cpp",
        "patchSetId": 9
      },
      "lineNbr": 726,
      "author": {
        "id": 1002054
      },
      "writtenOn": "2011-10-11T17:15:52Z",
      "side": 1,
      "message": "I don\u0027t understand why you don\u0027t do just this:\n\nif (!m_frames_received % m_pFilter-\u003em_decimate) {\n    // Drop every decimate frame.\n    return S_OK;\n  }\n\nThe code above won\u0027t change timestamps, which I think is cleaner.",
      "revId": "79ff71462cef27e6a981ea46b98c5ffe6a06c124",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "AAAAFn//0VQ\u003d",
        "filename": "vp8encoder/vp8encoderinpin.cpp",
        "patchSetId": 9
      },
      "lineNbr": 726,
      "author": {
        "id": 1002833
      },
      "writtenOn": "2011-10-11T18:51:31Z",
      "side": 1,
      "message": "I agree with FG.  Why are you trying to manipulate the framerate?",
      "parentUuid": "AAAAFn//0Z4\u003d",
      "revId": "79ff71462cef27e6a981ea46b98c5ffe6a06c124",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "AAAAFn//0Y0\u003d",
        "filename": "vp8encoder/vp8encoderinpin.cpp",
        "patchSetId": 9
      },
      "lineNbr": 726,
      "author": {
        "id": 1002431
      },
      "writtenOn": "2011-10-11T19:00:26Z",
      "side": 1,
      "message": "The reason I did things this way is that I\u0027m concerned a downstream filter might care about frame duration. I don\u0027t think the WebM muxer does, but others might.\n\nTo expand on that: I think it\u0027s possible that use of the simpler decimation method with a variable input frame rate could result in a sample_time(N) that\u0027s less than sample_time(N-1) + sample_duration(N-1)...\n\nSince we only really care about WebM I can change the code to do things the simpler way, but keeping timestamps as accurate as possible seemed like the correct thing to do when I was writing the code.\n\n\u003e I agree with FG. Why are you trying to manipulate the framerate?\n\nDecimation discards frames-- the main use case here is to take 1080p/720p 60 frames/second input, and encode it at 30 frames/second.  Outputting frames at 30/second with frames that have times and durations for 60 frame/second content would be incorrect.",
      "parentUuid": "AAAAFn//0Z4\u003d",
      "revId": "79ff71462cef27e6a981ea46b98c5ffe6a06c124",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "AAAAFn//0T0\u003d",
        "filename": "vp8encoder/vp8encoderinpin.cpp",
        "patchSetId": 9
      },
      "lineNbr": 726,
      "author": {
        "id": 1002833
      },
      "writtenOn": "2011-10-11T19:17:52Z",
      "side": 1,
      "message": "We of course you must change the stop time of the frame (which determines the value of the frame duration), but why do you think you need to change the start time?\n\nTo keep things simple you might need to set the stop time of the output frame to NULL (so that the output frame does not have a stop time at all).",
      "parentUuid": "AAAAFn//0Y0\u003d",
      "revId": "79ff71462cef27e6a981ea46b98c5ffe6a06c124",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "AAAAFn//0Sw\u003d",
        "filename": "vp8encoder/vp8encoderinpin.cpp",
        "patchSetId": 9
      },
      "lineNbr": 726,
      "author": {
        "id": 1002054
      },
      "writtenOn": "2011-10-11T19:42:10Z",
      "side": 1,
      "message": "Matt and I talked about it more. We think the best would be to change the stop time of the samples to 0 if decimate is \u003e 1. If not decimating than just use the stop time that is in the media sample.  This way it will be up to the muxer to figure out what the start and stop times of the frames are. You will just need to test that the muxer can handle this mode.",
      "parentUuid": "AAAAFn//0T0\u003d",
      "revId": "79ff71462cef27e6a981ea46b98c5ffe6a06c124",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "AAAAFn//0Ak\u003d",
        "filename": "vp8encoder/vp8encoderinpin.cpp",
        "patchSetId": 9
      },
      "lineNbr": 726,
      "author": {
        "id": 1002431
      },
      "writtenOn": "2011-10-11T23:24:29Z",
      "side": 1,
      "message": "I\u0027m changing it to the initial simple implementation Frank asked about. We can\u0027t pass a duration of 0 to libvpx, so to keep things simple I\u0027ll just use AvgTimePerFrame * decimate when decimate is \u003e 1.\n\nWe can revisit this later if needed-- the source device (in the use case this is intended for) should provide a constant frame rate.",
      "parentUuid": "AAAAFn//0Sw\u003d",
      "revId": "79ff71462cef27e6a981ea46b98c5ffe6a06c124",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "AAAAFn//0To\u003d",
        "filename": "vp8encoder/vp8encoderinpin.cpp",
        "patchSetId": 9
      },
      "lineNbr": 842,
      "author": {
        "id": 1002833
      },
      "writtenOn": "2011-10-11T19:17:52Z",
      "side": 1,
      "message": "Alternatively, you could say:\n\n__int64 duration_ \u003d GetAvgTimePerFrame();\n\nif (decimate \u003e\u003d 2)\n  duration_ *\u003d decimate;",
      "revId": "79ff71462cef27e6a981ea46b98c5ffe6a06c124",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}